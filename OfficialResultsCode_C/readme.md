Official results code, refactored in C to run faster! 